# ずんだもんBot 仕様書

## 目的
- 東北弁で可愛く答えるAIチャットBotとして、Discordでログを要約し、ユーザーと対話する。

## 機能
- **ログ管理**:
  - 20KBごとにログを要約（DeepSeek R1使用）。
  - レート制限中は10KBごとに仮要約（Mixtral 8x7B使用）。
- **応答生成**:
  - ユーザー質問に東北弁で回答（DeepSeek R1またはMixtral 8x7B）。
  - トークン上限（7,500トークン/日）を超えた場合、軽量モデルで仮回答。
- **同時処理抑制**:
  - 同時リクエストを3件に制限（`asyncio.Queue`使用）。
- **通知オプション**:
  - `!zunda notify on/off`で通知を切り替え可能（デフォルトオン）。
- **エラーログ保存**:
  - `error_logs.txt`にタイムスタンプ付きでエラー記録。

## 技術要件
- **環境**: Replit無料枠（CPU、512MB RAM）。
- **モデル**:
  - DeepSeek R1（推論用、7,500トークン/日制限）。
  - Mixtral 8x7B（8-bit量子化、仮要約用）。
- **言語**: Python 3.x。
- **ライブラリ**:
  - `discord.py`, `openrouter`, `transformers`, `tiktoken`, `bitsandbytes`。

## 制約
- 処理が重い場合、応答に時間がかかる。
- トークン上限に達すると24時間待機が必要。
- Discordのレート制限（50リクエスト/秒、10,000リクエスト/10分）対応（1秒/30秒待機）。

## ライセンス
MITライセンス（変更可能）。